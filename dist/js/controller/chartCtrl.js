app.controller("chartCtrl",["$scope","$injector",function(a,t){t.invoke(["chartLouder",function(t){document.title="统计图表",a.options=[{id:"",year:"请选择起始时间"}];for(var e=1980,r=0;r<41;r++){var c={id:e,year:e};a.options.push(c),e++}a.tableInfo=[],a.searchTabel=function(){var e={beginYearStr:a.projectStatistics.startDate,endYearStr:a.projectStatistics.endDate};t.getTableInfo(e).then(function(t){a.tableInfo=t.data})},a.projectStatistics={startDate:(new Date).getFullYear(),endDate:(new Date).getFullYear(),panel_1:!0,panel_2:!1,panel_3:!1,panel_4:!1,switch:function(t){a.projectStatistics.panel_1=!1,a.projectStatistics.panel_2=!1,a.projectStatistics.panel_3=!1,a.projectStatistics.panel_4=!1,a.projectStatistics["panel_"+t]=!0}},a.loadChart=function(e){t.getChartInfo({projectTypeStr:e}).then(function(t){if(t.data.Success){for(var e={x:[],xValue:[]},r=0;r<t.data.Result.length;r++)e.x.push(t.data.Result[r].StageName),e.xValue.push(t.data.Result[r].ProjectCount);var c=echarts.init(document.getElementById("main")),n={title:{text:"项目进度"},tooltip:{},legend:{data:["销量"]},xAxis:{axisLabel:{interval:0,formatter:function(a){return a.split("").join("\n")}},data:e.x},yAxis:{},grid:{containLabel:!0},series:[{name:"销量",type:"bar",data:e.xValue}]};c.setOption(n)}else a.chartTisp="图表数据加载失败，请稍后再试"})},a.loadChart("FundsPhase"),a.chart={title:"常规",chart1:!0,chart2:!1,switchChart:function(t){a.chart.chart1=!1,a.chart.chart2=!1,a.chart["chart"+t]=!0,1==t?(a.chart.title="常规",a.loadChart("FundsPhase")):(a.chart.title="金关",a.loadChart("GoldenPhase"))}},a.searchDataPage={pageNum:1,pageSize:10},a.loadMore=!0,a.loading=!1,a.searchInfo=[],a.loadSearch=function(e,r){r&&(a.searchDataPage.pageNum=1),a.searchData={},e?(a.searchData.pageNum=a.searchDataPage.pageNum,a.searchData.pageSize=a.searchDataPage.pageSize,a.searchData.inputStr=a.searchStr,console.log(1)):(a.searchData.pageNum=a.searchDataPage.pageNum,a.searchData.pageSize=a.searchDataPage.pageSize,a.searchData.projectType="",a.searchData.projectStage="",console.log(2)),t.getSearchInfo(a.searchData,e).then(function(t){if(e)a.searchInfo={},a.searchInfo=t.data;else{var r=[];angular.copy(a.searchInfo,r),a.searchInfo=r.concat(t.data)}a.loading=!1;for(var c=0;c<a.searchInfo.lenght;c++)a.searchInfo.animate=!1;t.data.length<10&&(a.loadMore=!1)})},a.loadSearch(!1),a.toggleAnimate=function(t){a.searchInfo[t].animate=!a.searchInfo[t].animate},a.loadData=function(){a.loading=!0,a.searchDataPage.pageNum+=1;var t=!(!a.searchStr&&""!=a.searchStr);a.loadSearch(t)},weui.searchBar("#searchBar")}])}]);